(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-490b77bb"],{d3c1:function(t,e,a){"use strict";a.r(e);var r=function(){var t=this,e=t.$createElement,r=t._self._c||e;return r("div",{staticClass:"topic"},[r("el-container",[r("el-header",[r("div",[r("span",[t._v("*")]),r("span",[t._v("前8个话题将会在app导航栏中显示")])]),r("div",{staticClass:"globalSearchBtnBg",on:{click:t.addTopic}},[t._v("新建话题")]),r("div",{staticClass:"globalHistoryDeleteBtnBg",staticStyle:{"margin-right":"20px"},on:{click:t.openDeleteHistory}},[t._v("删除历史")])]),r("el-main",[[r("el-table",{directives:[{name:"loading",rawName:"v-loading",value:t.loading,expression:"loading"}],staticStyle:{width:"100%"},attrs:{data:t.tableData,"row-key":"topicId","row-class-name":"el-dragRowCls",stripe:"","max-height":"700",border:""}},[r("el-table-column",{attrs:{prop:"number",label:"序号",width:"50"},scopedSlots:t._u([{key:"default",fn:function(e){return[t._v(t._s(e.$index+1))]}}])}),r("el-table-column",{attrs:{prop:"topicName",label:"话题名称"}}),r("el-table-column",{attrs:{prop:"createTime",label:"创建时间"}}),r("el-table-column",{attrs:{prop:"blogCount",label:"动态数"}}),r("el-table-column",{attrs:{prop:"synopsis",label:"话题简介","show-overflow-tooltip":""}}),r("el-table-column",{attrs:{prop:"topicPic",label:"话题头像"},scopedSlots:t._u([{key:"default",fn:function(t){return[r("img",{staticStyle:{width:"30px",height:"30px"},attrs:{src:t.row.topicPic,alt:""}})]}}])}),r("el-table-column",{attrs:{prop:"background",label:"话题背景"},scopedSlots:t._u([{key:"default",fn:function(t){return[r("img",{staticStyle:{width:"110px",height:"30px"},attrs:{src:t.row.background,alt:""}})]}}])}),r("el-table-column",{attrs:{prop:"sort",label:"排序"},scopedSlots:t._u([{key:"default",fn:function(e){return[r("el-tooltip",{attrs:{content:"置顶",placement:"top"}},[r("img",{staticClass:"jiantou",attrs:{src:a("ad52"),alt:""},on:{click:function(a){return t.goTop(e.$index)}}})]),r("el-tooltip",{attrs:{content:"上移",placement:"top"}},[r("img",{staticClass:"jiantou",attrs:{src:a("ffcb"),alt:""},on:{click:function(a){return t.goUp(e.$index)}}})]),r("el-tooltip",{attrs:{content:"下移",placement:"top"}},[r("img",{staticClass:"jiantou",attrs:{src:a("8414"),alt:""},on:{click:function(a){return t.goDown(e.$index)}}})]),r("el-tooltip",{attrs:{content:"置底",placement:"top"}},[r("img",{staticClass:"jiantou jiantou4",attrs:{src:a("d950"),alt:""},on:{click:function(a){return t.goBottom(e.$index)}}})])]}}])}),r("el-table-column",{attrs:{prop:"status",label:"状态"},scopedSlots:t._u([{key:"default",fn:function(e){return[r("el-switch",{attrs:{value:1==e.row.status,"active-color":"#CAA267","inactive-color":"#FFFFFF"},on:{change:function(a){return t.changeStatus(e.$index,e.row)}},nativeOn:{click:function(e){return t.stopBubble(e)}}})]}}])}),r("el-table-column",{attrs:{prop:"operation",label:"操作"},scopedSlots:t._u([{key:"default",fn:function(e){return[r("button",{on:{click:function(a){return t.editTopic(e.row)}}},[t._v("修改")]),r("button",{staticClass:"deleteCls",on:{click:function(a){return t.deleteTopic(e.$index,e.row)}}},[t._v("删除")]),r("button",{staticClass:"logBtnCls",on:{click:function(a){return t.open_operationLog(e.row)}}},[t._v("日志")])]}}])})],1)]],2),r("el-dialog",{attrs:{visible:t.dialogVisible,title:t.modalTitle,"custom-class":"newTopicCls",width:"600px"},on:{"update:visible":function(e){t.dialogVisible=e},close:t.closeModal}},[r("div",[r("el-form",{ref:"topicForm",staticClass:"demo-ruleForm",attrs:{model:t.topicForm,"label-width":"90px"}},[r("el-form-item",{attrs:{label:"话题名称",prop:"topicName",rules:[{required:!0,message:"请输入话题名称",trigger:"blur"}]}},[r("el-input",{attrs:{placeholder:"限40个字",maxlength:"40"},model:{value:t.topicForm.topicName,callback:function(e){t.$set(t.topicForm,"topicName",e)},expression:"topicForm.topicName"}})],1),r("el-form-item",{attrs:{label:"话题简介",prop:"synopsis"}},[r("el-input",{attrs:{type:"textarea",placeholder:"限255个字",maxlength:"255"},model:{value:t.topicForm.synopsis,callback:function(e){t.$set(t.topicForm,"synopsis",e)},expression:"topicForm.synopsis"}})],1),r("el-form-item",{attrs:{label:"话题头像",prop:"topicPic",rules:[{required:!0,message:"请上传话题头像",trigger:"change"}]}},[r("el-upload",{staticClass:"avatar-uploader",attrs:{action:t.commonUploadUrl,"show-file-list":!1,"on-success":t.handleAvatarSuccess,"before-upload":t.beforeAvatarUpload}},[t.topicForm.topicPic?r("img",{staticClass:"avatar",attrs:{src:t.topicForm.topicPic}}):r("i",{staticClass:"el-icon-plus avatar-uploader-icon"})]),r("span",{staticClass:"imgtips"},[t._v("120px*120px")])],1),r("el-form-item",{attrs:{label:"话题背景",prop:"background",rules:[{required:!0,message:"请上传话题背景",trigger:"change"}]}},[r("el-upload",{staticClass:"avatar-uploader",attrs:{action:t.commonUploadUrl,"show-file-list":!1,"on-success":t.handleAvatarSuccess1,"before-upload":t.beforeAvatarUpload}},[t.topicForm.background?r("img",{staticClass:"avatar avatar1",attrs:{src:t.topicForm.background}}):r("i",{staticClass:"el-icon-plus avatar-uploader-icon avatar-uploader-icon1"})]),r("span",{staticClass:"imgtips"},[t._v("750px*220px")])],1),r("el-form-item",{attrs:{label:"话题导航",prop:"pictureUrl",rules:[{required:!0,message:"请上传话题导航",trigger:"change"}]}},[r("el-upload",{staticClass:"avatar-uploader",attrs:{action:t.commonUploadUrl,"show-file-list":!1,"on-success":t.handleAvatarSuccess2,"before-upload":t.beforeAvatarUpload}},[t.topicForm.pictureUrl?r("img",{staticClass:"avatar avatar2",attrs:{src:t.topicForm.pictureUrl}}):r("i",{staticClass:"el-icon-plus avatar-uploader-icon avatar-uploader-icon2"})]),r("span",{staticClass:"imgtips"},[t._v("268px*140px")])],1),r("el-form-item",[r("el-button",{on:{click:function(e){t.dialogVisible=!1}}},[t._v("取消")]),r("el-button",{attrs:{type:"primary"},on:{click:function(e){return t.submitTopic("topicForm")}}},[t._v("确定")])],1)],1)],1)])],1),r("operationLog",{attrs:{operationLogModal:t.operationLogModal,operationlog_rowData:t.operationlog_rowData,Operationlog_fromMark:t.Operationlog_fromMark},on:{operationlog_childEvent:t.operationLog_parentMethod}}),r("deleteHistoryLog",{attrs:{deleteHistoryLogModal:t.deleteHistoryLogModal,deleteHistoryRow:t.deleteHistoryRow,fromPage:t.fromPage},on:{deleteHistoryLog_childEvent:t.deleteHistoryLog_parentMethod,sycncRefresh_childEvent:t.sycncRefresh_parentMethod}})],1)},o=[],n=(a("8e6e"),a("ac6a"),a("456d"),a("96cf"),a("3b8d")),i=a("bd86"),s=a("2f62"),c=a("aa47"),l=a("e5de"),p=a("f670");function u(t,e){var a=Object.keys(t);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(t);e&&(r=r.filter(function(e){return Object.getOwnPropertyDescriptor(t,e).enumerable})),a.push.apply(a,r)}return a}function d(t){for(var e=1;e<arguments.length;e++){var a=null!=arguments[e]?arguments[e]:{};e%2?u(a,!0).forEach(function(e){Object(i["a"])(t,e,a[e])}):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(a)):u(a).forEach(function(e){Object.defineProperty(t,e,Object.getOwnPropertyDescriptor(a,e))})}return t}var g={name:"CommentCheck",components:{operationLog:l["a"],deleteHistoryLog:p["a"]},computed:d({},Object(s["b"])(["appId"])),data:function(){return{loading:!1,tableData:[],dialogVisible:!1,topicForm:{topicName:"",synopsis:"",topicPic:"",background:"",pictureUrl:""},commonUploadUrl:this.api.getHongqiUploadUrl(),modalTitle:"新建话题",isEditFlag:!1,operationLogModal:!1,operationlog_rowData:"",Operationlog_fromMark:"",deleteHistoryLogModal:!1,deleteHistoryRow:"",fromPage:""}},methods:{validateTopicname:function(t,e,a){""===e||null==e?a(new Error("请输入话题名称！")):(e.length>40&&a(new Error("话题名称长度不得超过40！")),a())},validateTopicdesc:function(t,e,a){""===e||null==e?a():(e.length>255&&a(new Error("话题简介长度不得超过255！")),a())},rowDrop:function(){var t=document.querySelector(".topic .el-table__body-wrapper tbody"),e=this;c["a"].create(t,{animation:150,ghostClass:"sortable-ghost-class",onEnd:function(t){var a=t.newIndex,r=t.oldIndex,o=e.tableData.splice(r,1)[0];e.tableData.splice(a,0,o),e.updateTopicFunc()}})},stopBubble:function(t){t.stopPropagation()},swapItem:function(t,e){this.tableData[t]=this.tableData.splice(e,1,this.tableData[t])[0]},goTop:function(){var t=Object(n["a"])(regeneratorRuntime.mark(function t(e){return regeneratorRuntime.wrap(function(t){while(1)switch(t.prev=t.next){case 0:if(0!=e){t.next=3;break}return this.$message({type:"warning",message:"到顶了！"}),t.abrupt("return");case 3:this.tableData.unshift(this.tableData.splice(e,1)[0]),this.updateTopicFunc();case 5:case"end":return t.stop()}},t,this)}));function e(e){return t.apply(this,arguments)}return e}(),goUp:function(){var t=Object(n["a"])(regeneratorRuntime.mark(function t(e){return regeneratorRuntime.wrap(function(t){while(1)switch(t.prev=t.next){case 0:if(0!=e){t.next=3;break}return this.$message({type:"warning",message:"到顶了！"}),t.abrupt("return");case 3:this.swapItem(e,e-1),this.updateTopicFunc();case 5:case"end":return t.stop()}},t,this)}));function e(e){return t.apply(this,arguments)}return e}(),goDown:function(){var t=Object(n["a"])(regeneratorRuntime.mark(function t(e){return regeneratorRuntime.wrap(function(t){while(1)switch(t.prev=t.next){case 0:if(e!=this.tableData.length-1){t.next=3;break}return this.$message({type:"warning",message:"到底了！"}),t.abrupt("return");case 3:this.swapItem(e,e+1),this.updateTopicFunc();case 5:case"end":return t.stop()}},t,this)}));function e(e){return t.apply(this,arguments)}return e}(),goBottom:function(){var t=Object(n["a"])(regeneratorRuntime.mark(function t(e){return regeneratorRuntime.wrap(function(t){while(1)switch(t.prev=t.next){case 0:if(e!=this.tableData.length-1){t.next=3;break}return this.$message({type:"warning",message:"到底了！"}),t.abrupt("return");case 3:this.tableData.push(this.tableData.splice(e,1)[0]),this.updateTopicFunc();case 5:case"end":return t.stop()}},t,this)}));function e(e){return t.apply(this,arguments)}return e}(),updateTopicFunc:function(){var t=Object(n["a"])(regeneratorRuntime.mark(function t(){var e;return regeneratorRuntime.wrap(function(t){while(1)switch(t.prev=t.next){case 0:return t.prev=0,t.next=3,this.api.updateTopicSort(this.tableData);case 3:e=t.sent,e.success?this.$message({type:"success",message:e.message}):this.$message({type:"error",message:e.message}),t.next=10;break;case 7:t.prev=7,t.t0=t["catch"](0),console.log(t.t0);case 10:case"end":return t.stop()}},t,this,[[0,7]])}));function e(){return t.apply(this,arguments)}return e}(),getTopicList:function(){var t=Object(n["a"])(regeneratorRuntime.mark(function t(){var e;return regeneratorRuntime.wrap(function(t){while(1)switch(t.prev=t.next){case 0:return t.prev=0,this.loading=!0,t.next=4,this.api.getTopic({appInfoId:this.appId});case 4:e=t.sent,this.tableData=e.data,this.loading=!1,t.next=13;break;case 9:t.prev=9,t.t0=t["catch"](0),console.log(t.t0),this.loading=!1;case 13:case"end":return t.stop()}},t,this,[[0,9]])}));function e(){return t.apply(this,arguments)}return e}(),changeStatus:function(t,e){var a=this;1==e.status?this.$confirm("确定要禁止此条话题吗？",{confirmButtonText:"确定",cancelButtonText:"取消",type:"warning"}).then(Object(n["a"])(regeneratorRuntime.mark(function r(){var o;return regeneratorRuntime.wrap(function(r){while(1)switch(r.prev=r.next){case 0:return r.prev=0,r.next=3,a.api.auditTopic({appInfoId:a.appId,topicId:e.topicId,status:0});case 3:o=r.sent,o.success?(a.tableData[t].status="0",a.$message({type:"success",message:"操作成功!"})):a.$message({type:"error",message:"操作失败!"}),r.next=10;break;case 7:r.prev=7,r.t0=r["catch"](0),console.log(r.t0);case 10:case"end":return r.stop()}},r,null,[[0,7]])}))).catch(function(){}):this.$confirm("确定要显示此条话题吗？",{confirmButtonText:"确定",cancelButtonText:"取消",type:"warning"}).then(Object(n["a"])(regeneratorRuntime.mark(function r(){var o;return regeneratorRuntime.wrap(function(r){while(1)switch(r.prev=r.next){case 0:return r.prev=0,r.next=3,a.api.auditTopic({appInfoId:a.appId,topicId:e.topicId,status:1});case 3:o=r.sent,o.success?(a.tableData[t].status="1",a.$message({type:"success",message:"操作成功!"})):a.$message({type:"error",message:"操作失败!"}),r.next=10;break;case 7:r.prev=7,r.t0=r["catch"](0),console.log(r.t0);case 10:case"end":return r.stop()}},r,null,[[0,7]])}))).catch(function(){})},deleteTopic:function(t,e){var a=this;this.$confirm("确定要删除此条话题吗？",{confirmButtonText:"确定",cancelButtonText:"取消",type:"warning"}).then(Object(n["a"])(regeneratorRuntime.mark(function t(){var r;return regeneratorRuntime.wrap(function(t){while(1)switch(t.prev=t.next){case 0:return t.prev=0,t.next=3,a.api.deleteTopic({appInfoId:a.appId,topicId:e.topicId});case 3:r=t.sent,r.success?(a.getTopicList(),a.$message({type:"success",message:"删除成功!"})):a.$message({type:"error",message:"删除失败!"}),t.next=10;break;case 7:t.prev=7,t.t0=t["catch"](0),console.log(t.t0);case 10:case"end":return t.stop()}},t,null,[[0,7]])}))).catch(function(){})},handleAvatarSuccess:function(t,e){this.topicForm.topicPic=t.data[0]},handleAvatarSuccess1:function(t,e){this.topicForm.background=t.data[0]},handleAvatarSuccess2:function(t,e){this.topicForm.pictureUrl=t.data[0]},beforeAvatarUpload:function(t){var e="image/jpeg"===t.type,a="image/png"===t.type,r=t.size/1024/1024<2;return e||a||this.$message.error("上传头像图片只能是 JPG/png 格式!"),r||this.$message.error("上传头像图片大小不能超过 2MB!"),(e||a)&&r},addTopic:function(){this.modalTitle="新建话题",this.topicForm={topicName:"",synopsis:"",topicPic:"",background:"",pictureUrl:""},this.dialogVisible=!0,this.isEditFlag=!1},editTopic:function(){var t=Object(n["a"])(regeneratorRuntime.mark(function t(e){var a;return regeneratorRuntime.wrap(function(t){while(1)switch(t.prev=t.next){case 0:return this.modalTitle="修改话题",this.isEditFlag=!0,t.prev=2,t.next=5,this.api.getTopicById({appInfoId:this.appId,topicId:e.topicId});case 5:a=t.sent,a.success?(this.dialogVisible=!this.dialogVisible,this.topicForm=a.data[0]):this.$message({type:"error",message:"获取信息失败!"}),t.next=12;break;case 9:t.prev=9,t.t0=t["catch"](2),console.log(t.t0);case 12:case"end":return t.stop()}},t,this,[[2,9]])}));function e(e){return t.apply(this,arguments)}return e}(),closeModal:function(){void 0!==this.$refs["topicForm"]&&this.$refs["topicForm"].resetFields()},submitTopic:function(){var t=Object(n["a"])(regeneratorRuntime.mark(function t(e){var a=this;return regeneratorRuntime.wrap(function(t){while(1)switch(t.prev=t.next){case 0:this.$refs[e].validate(function(t){t?a.submitFunc():a.$message.error("校验失败！")});case 1:case"end":return t.stop()}},t,this)}));function e(e){return t.apply(this,arguments)}return e}(),submitFunc:function(){var t=Object(n["a"])(regeneratorRuntime.mark(function t(){var e;return regeneratorRuntime.wrap(function(t){while(1)switch(t.prev=t.next){case 0:if(t.prev=0,this.topicForm.appInfoId=this.appId,this.topicForm.createId=1,!this.isEditFlag){t.next=9;break}return t.next=6,this.api.updateTopic(this.topicForm);case 6:e=t.sent,t.next=12;break;case 9:return t.next=11,this.api.addTopic(this.topicForm);case 11:e=t.sent;case 12:e.success?(this.$message({type:"success",message:e.message}),this.getTopicList(),this.dialogVisible=!this.dialogVisible):this.$message({type:"error",message:e.message}),t.next=18;break;case 15:t.prev=15,t.t0=t["catch"](0),console.log(t.t0);case 18:case"end":return t.stop()}},t,this,[[0,15]])}));function e(){return t.apply(this,arguments)}return e}(),open_operationLog:function(t){this.operationLogModal=!0,this.operationlog_rowData=t,this.Operationlog_fromMark="topic"},operationLog_parentMethod:function(t){this.operationLogModal=t.operationLogModal},openDeleteHistory:function(t){this.deleteHistoryLogModal=!0,this.deleteHistoryRow=t,this.fromPage="topic"},deleteHistoryLog_parentMethod:function(t){this.deleteHistoryLogModal=t.deleteHistoryLogModal},sycncRefresh_parentMethod:function(){this.getTopicList()}},mounted:function(){this.rowDrop(),this.getTopicList()}},m=g,h=(a("e981"),a("2877")),f=Object(h["a"])(m,r,o,!1,null,null,null);e["default"]=f.exports},e981:function(t,e,a){"use strict";var r=a("f11b"),o=a.n(r);o.a},f11b:function(t,e,a){}}]);