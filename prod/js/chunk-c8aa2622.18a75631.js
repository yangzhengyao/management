(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-c8aa2622"],{e07d:function(t,e,a){},e349:function(t,e,a){"use strict";var n=a("e07d"),s=a.n(n);s.a},f2b5:function(t,e,a){"use strict";a.r(e);var n=function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("div",{staticClass:"department"},[a("el-container",[a("el-header",{staticStyle:{display:"flex","justify-content":"space-between"}},[a("div",{staticClass:"header-left"},[a("div",{staticClass:"select2"},[a("span",[t._v("日期")]),a("el-date-picker",{attrs:{type:"daterange","range-separator":"至","start-placeholder":"开始日期","end-placeholder":"结束日期","value-format":"yyyy-MM-dd","unlink-panels":!0},model:{value:t.dateRange,callback:function(e){t.dateRange=e},expression:"dateRange"}})],1)]),a("div",{staticClass:"header-right globalSearchBtnBg"},[a("p",{staticClass:"search",on:{click:t.getDepartmentStatistic}},[t._v("检索")])])]),a("el-main",[[a("el-table",{directives:[{name:"loading",rawName:"v-loading",value:t.loading,expression:"loading"}],staticStyle:{width:"100%"},attrs:{data:t.tableData,stripe:"","max-height":"670",border:""}},[a("el-table-column",{attrs:{prop:"name",label:"部门"}}),a("el-table-column",{attrs:{prop:"CO",label:"多媒稿件"},scopedSlots:t._u([{key:"default",fn:function(e){return["总计"==e.row.name?a("span",{staticStyle:{color:"#C93931"}},[t._v(t._s(e.row.CO||0))]):a("span",[t._v(t._s(e.row.CO||0))])]}}])}),a("el-table-column",{attrs:{prop:"TX",label:"文字稿"},scopedSlots:t._u([{key:"default",fn:function(e){return["总计"==e.row.name?a("span",{staticStyle:{color:"#C93931"}},[t._v(t._s(e.row.TX||0))]):a("span",[t._v(t._s(e.row.TX||0))])]}}])}),a("el-table-column",{attrs:{prop:"PO",label:"图片稿"},scopedSlots:t._u([{key:"default",fn:function(e){return["总计"==e.row.name?a("span",{staticStyle:{color:"#C93931"}},[t._v(t._s(e.row.PO||0))]):a("span",[t._v(t._s(e.row.PO||0))])]}}])}),a("el-table-column",{attrs:{prop:"GR",label:"图表稿"},scopedSlots:t._u([{key:"default",fn:function(e){return["总计"==e.row.name?a("span",{staticStyle:{color:"#C93931"}},[t._v(t._s(e.row.GR||0))]):a("span",[t._v(t._s(e.row.GR||0))])]}}])}),a("el-table-column",{attrs:{prop:"GA",label:"图集稿"},scopedSlots:t._u([{key:"default",fn:function(e){return["总计"==e.row.name?a("span",{staticStyle:{color:"#C93931"}},[t._v(t._s(e.row.GA||0))]):a("span",[t._v(t._s(e.row.GA||0))])]}}])}),a("el-table-column",{attrs:{prop:"VD",label:"视频稿"},scopedSlots:t._u([{key:"default",fn:function(e){return["总计"==e.row.name?a("span",{staticStyle:{color:"#C93931"}},[t._v(t._s(e.row.VD||0))]):a("span",[t._v(t._s(e.row.VD||0))])]}}])}),a("el-table-column",{attrs:{prop:"AU",label:"音频稿"},scopedSlots:t._u([{key:"default",fn:function(e){return["总计"==e.row.name?a("span",{staticStyle:{color:"#C93931"}},[t._v(t._s(e.row.AU||0))]):a("span",[t._v(t._s(e.row.AU||0))])]}}])}),a("el-table-column",{attrs:{prop:"LV",label:"直播稿"},scopedSlots:t._u([{key:"default",fn:function(e){return["总计"==e.row.name?a("span",{staticStyle:{color:"#C93931"}},[t._v(t._s(e.row.LV||0))]):a("span",[t._v(t._s(e.row.LV||0))])]}}])}),a("el-table-column",{attrs:{prop:"HR",label:"链接稿"},scopedSlots:t._u([{key:"default",fn:function(e){return["总计"==e.row.name?a("span",{staticStyle:{color:"#C93931"}},[t._v(t._s(e.row.HR||0))]):a("span",[t._v(t._s(e.row.HR||0))])]}}])}),a("el-table-column",{attrs:{prop:"WX",label:"微信稿"},scopedSlots:t._u([{key:"default",fn:function(e){return["总计"==e.row.name?a("span",{staticStyle:{color:"#C93931"}},[t._v(t._s(e.row.WX||0))]):a("span",[t._v(t._s(e.row.WX||0))])]}}])})],1)],a("div",{staticClass:"table-bottom"},[a("el-button",{attrs:{type:"primary",disabled:0==t.tableData.length},on:{click:t.exportDepartmentExcel}},[t._v("导出Excel")])],1)],2)],1)],1)},s=[],o=(a("96cf"),a("3b8d")),r=a("bc3a"),l=a.n(r),c={name:"department",components:{},data:function(){return{dateRange:[this.commonFunc.formatDate(Date.now()-2592e6),this.commonFunc.formatDate(Date.now())],loading:!1,currentPage:1,pageSize:10,pageTotal:0,tableData:[]}},mounted:function(){this.getDepartmentStatistic()},watch:{currentPage:function(t,e){}},methods:{getDepartmentStatistic:function(){var t=Object(o["a"])(regeneratorRuntime.mark(function t(){var e,a;return regeneratorRuntime.wrap(function(t){while(1)switch(t.prev=t.next){case 0:return this.loading=!0,t.prev=1,e={startDate:this.dateRange&&this.dateRange.length>0?this.dateRange[0]:"",endDate:this.dateRange&&this.dateRange.length>0?this.dateRange[1]:""},t.next=5,this.api.getDepartmentStatistic(e);case 5:a=t.sent,a.success?(this.loading=!1,this.tableData=a.data[0].data):(this.loading=!1,this.$message({type:"error",message:a.message})),t.next=12;break;case 9:t.prev=9,t.t0=t["catch"](1),console.log(t.t0);case 12:case"end":return t.stop()}},t,this,[[1,9]])}));function e(){return t.apply(this,arguments)}return e}(),exportDepartmentExcel:function(){var t=this,e=this.$loading({lock:!0,text:"Loading",spinner:"el-icon-loading",background:"rgba(0, 0, 0, 0.7)"}),a=this.api.getUrl();l()({method:"post",url:a+"export/exportDepartmentExcel",data:{startDate:this.dateRange&&this.dateRange.length>0?this.dateRange[0]:"",endDate:this.dateRange&&this.dateRange.length>0?this.dateRange[1]:""},responseType:"arraybuffer"}).then(function(a){t.commonFunc.exportExcel(a,"部门统计.xls",t),e.close()}).catch(function(t){})}}},i=c,p=(a("e349"),a("2877")),u=Object(p["a"])(i,n,s,!1,null,null,null);e["default"]=u.exports}}]);